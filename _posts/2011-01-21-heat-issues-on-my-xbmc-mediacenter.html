---
title: "Heat issues on my XBMC mediacenter"
layout: "post"
permalink: "/2011/01/heat-issues-on-my-xbmc-mediacenter.html"
uuid: "505456519393833950"
guid: "tag:blogger.com,1999:blog-4675781771561437973.post-505456519393833950"
date: "2011-01-21 21:47:00"
updated: "2011-01-21 21:47:44"
description: 
blogger:
    siteid: "4675781771561437973"
    postid: "505456519393833950"
categories: 
comments: true
---

{% raw %}
<div class="css-full-post-content js-full-post-content">
I run an XBMC mediacenter at home, on my old Compaq C765 laptop (the laptop I used to use as a Hackintosh, until I got a real Mac). &nbsp;I say it's old, but it's perfectly well powered:<br /><br /><ul><li>2.1ghz Intel Core 2 Duo</li><li>2gb RAM</li><li>Intel GMA X3100 "graphics" adapter</li></ul><div>Apart from the X3100, it's a perfectly good little computer, and perfect for a media center. &nbsp;XBMC is super easy to install - just install Ubuntu as you normally would, and install the XBMC package using your favorite package manager ("apt-get install xbmc" will do it).</div><div><br /></div><div>What's great about XBMC is that all the configuration is through the TV graphical interface. &nbsp;No pain in the ass backend to configure (I'm looking at YOU MythTV), it just works. &nbsp;I like that. &nbsp;</div><div><br /></div><div>The real pain in the ass though, came when I wanted to play HD movies. &nbsp;The whole point of having a mediacenter is to keep all your movies and TV shows on a hard drive, so I ripped a couple of my favorite Planet Earth episodes in HD, and gave it a shot. &nbsp;Unfortunately, Ubuntu's built in HD video decoder (libavcodec/ffdshow/ffmpeg) requires too much power for my little mediacenter. &nbsp;I couldn't get through the intro without seeing significant lag behind the audio,and ultimately tons of dropped frames.</div><div><br /></div><div>On Windows, the solution is simple - get a commercial HD decoder software package. &nbsp;CoreAVC has a reputation as the best in the business. &nbsp;This is partly because it's multi-threaded, and partly just because it's so well written! &nbsp;Most people see at least a 30% gain in their framerates with this decoder.</div><div><br /></div><div>As I mentioned though, it's commercial. I don't like paying for software on a gamble, so I tried downloading the 14 day trial to play with at first. &nbsp;These instructions should work with the trial... I just ran a few benchmarks on one of my other systems, and was satisfied enough to pony up the $15. &nbsp;Here are the steps I followed (For Ubuntu 9.10)</div><div><br /></div><div><ol><li>Install the tools you need to build mplayer over again, and to build coreavc-for-linux:<br /><blockquote>sudo apt-get install subversion build-essential xorg-dev pkg-config gcc-4.3 wine</blockquote>(honestly you shouldn't need to explicitly install gcc-4.3 unless you upgraded from karmic like I did - badly)</li><li>Make a directory to work in, and download the sources you need:<br /><blockquote>mkdir ~/cursing</blockquote><blockquote>cd ~cursing</blockquote><blockquote>svn checkout svn://svn.mplayerhq.hu/mplayer/trunk mplayer</blockquote><blockquote>svn checkout http://coreavc-for-linux.googlecode.com/svn/trunk/ coreavc-for-linux&nbsp;</blockquote>Also download CoreAVC! &nbsp;As I mentioned, I only ever tried this with the registered version, but there's no reason you shouldn't be able to do it with the shareware version as well.&nbsp;</li><li>Install CoreAVC using WINE (you don't run it using WINE, but you do have to install it to pull out the library!)<br /><blockquote>wine "~/Desktop/CoreAVC Professional Edition-x.x.x_Setup.exe"</blockquote>This is where you get to enter your serial number, or deal with the demo. &nbsp;The installer will work just like a windows installer, because Wine is just that badass.</li><li>Install DShowServer:<br /><blockquote>cd dshowserver/precompiled</blockquote><blockquote>make install</blockquote></li><li>Copy your freshly installed CoreAVC library into the dshowserver directory so it's easy to find:<br /><blockquote>sudo cp "~/.wine/drive_c/Program Files/CoreCodec/CoreAVC Professional Edition/CoreAVCDecoder.ax" /usr/local/share/dshowserver&nbsp;</blockquote></li></ol>At this point you should take a break. &nbsp;Hey, that was a lot of work! &nbsp;Get a coffee, put on some music or something. &nbsp;And you can feel good about the progress you made! &nbsp;Look at that, dshowserver can find and load CoreAVC: &nbsp;</div><div><blockquote>dshowserver -c CoreAVCDecoder.ax</blockquote><blockquote><span class="Apple-style-span" style="font-family: arial, sans-serif; font-size: 13px;"><pre class="prettyprint" style="border-left-color: rgb(204, 204, 204); border-left-style: solid; border-left-width: 3px; font-size: 12px; margin-left: 2em; padding-bottom: 0.5em; padding-left: 0.5em; padding-right: 0.5em; padding-top: 0.5em;"><span class="typ">No</span><span class="pln"> id specified</span><span class="pun">,</span><span class="pln"> assuming test mode</span><span class="typ">Opening</span><span class="pln"> device<br />len</span><span class="pun">:</span><span class="pln"> </span><span class="lit">992</span><span class="pln"><br /></span><span class="typ">ProductVersion</span><span class="pun">:</span><span class="pln"> </span><span class="lit">2.0</span><span class="pun">.</span><span class="lit">0</span><span class="pln"><br /></span><span class="typ">Decoder</span><span class="pln"> supports the following YUV formats</span><span class="pun">:</span><span class="pln"> YUY2 UYVY YV12 I420 </span><span class="typ">Decoder</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> capable of YUV output </span><span class="pun">(</span><span class="pln">flags </span><span class="lit">0x2b</span><span class="pun">)</span><span class="pln"><br /></span><span class="typ">Setting</span><span class="pln"> fmt</span><span class="typ">Starting</span><span class="pln"><br /></span><span class="typ">Initialization</span><span class="pln"> </span><span class="kwd">is</span><span class="pln"> complete</span></pre></span></blockquote></div><div>That's like half the battle, right there! &nbsp;</div><div><br /></div><div>Now that your legs are stretched, let's get mplayer using this new shiny codec.</div><div><br /></div><div><ol><li>Mplayer out of the box doesn't support dshowserver, so we have to patch the source a little:<br /><br /><blockquote>cd mplayer-source-dir&nbsp;</blockquote><blockquote>patch -p0 &lt; ../coreavc-for-linux-source-dir/mplayer/dshowserver.patch</blockquote></li><li>Compile and install mplayer from this patched source:<br /><blockquote>make &amp;&amp; make install</blockquote></li><li>Now you just have to add the new codec to your ~/.mplayer/codecs.conf and you're away to the races! &nbsp;Add these lines to the end of codecs.conf :</li></ol><blockquote>videocodec coreserve info "CoreAVC DShow H264 decoder x.x for x86 - http://corecodec.org/"</blockquote><blockquote>&nbsp;&nbsp;status working</blockquote><blockquote>&nbsp;&nbsp;format 0x10000005</blockquote><blockquote>&nbsp;&nbsp;fourcc H264,h264 H264</blockquote><blockquote>&nbsp;&nbsp;fourcc X264,x264</blockquote><blockquote>&nbsp;&nbsp;fourcc avc1,AVC1 AVC1</blockquote><blockquote>&nbsp;&nbsp;fourcc davc,DAVC</blockquote><blockquote>&nbsp;&nbsp;fourcc VSSH</blockquote><blockquote>&nbsp;&nbsp;driver dshowserver</blockquote><blockquote>&nbsp;&nbsp;dll "CoreAVCDecoder.ax"</blockquote><blockquote>&nbsp;&nbsp;guid 0x09571a4b, 0xf1fe, 0x4c60, 0x97, 0x60, 0xde, 0x6d, 0x31, 0x0c, 0x7c, 0x31</blockquote><blockquote>&nbsp;&nbsp;out YV12,IYUV,I420,YUY2</blockquote></div><div><br />You do have to explicitly tell mplayer to use this codec on launch - use<br /><blockquote>mplayer -vc coreserve</blockquote>To get it to start. &nbsp;Have fun! &nbsp;My little lappy runs great, smooth HD video!<br /><br /></div>
</div>
{% endraw %}
